{
  "version": 3,
  "sources": ["../js/uploadtool.js"],
  "sourcesContent": ["// Local dependencies (bundled)\r\nimport $ from 'jquery'\r\nimport * as bootstrap from 'bootstrap'\r\nimport 'bootstrap/dist/css/bootstrap.min.css'\r\n\r\nwindow.$ = window.jQuery = $\r\nwindow.bootstrap = bootstrap\r\n\r\n$(async()=> {\r\n\r\n    var msgModal = new bootstrap.Modal(document.getElementById('modal'))\r\n\r\n    // ------- get file --------\r\n    $('#fileUpload').on('change', (e) => {\r\n        //alert('upload done')\r\n    });\r\n\r\n    $('#form').on('submit', async (e)=>{\r\n        e.preventDefault()\r\n\r\n        //show msg to user\r\n        $('#modalMsg').html('uploading')\r\n        msgModal.show()\r\n\r\n        const file = document.getElementById(\"fileUpload\").files[0]\r\n\r\n        var submitInfo = {\r\n            committer: $('#committer').val(),\r\n            msg: $('#msg').val(),\r\n            fileName: file.name,\r\n            fileBase64:await toBase64(file),\r\n        }\r\n\r\n        function toBase64(file){\r\n            //from https://stackoverflow.com/questions/36280818/how-to-convert-file-to-base64-in-javascript\r\n            return new Promise((resolve, reject) => {\r\n                const reader = new FileReader();\r\n                reader.readAsDataURL(file);\r\n                reader.onload = () => resolve(reader.result.split(',')[1]);\r\n                reader.onerror = reject;\r\n            });\r\n        }\r\n\r\n        //------ send file by cloudflare worker ------\r\n        $.ajax({\r\n            url:'https://githubuploader.katani.workers.dev/',\r\n            method: 'POST',\r\n            data:{\r\n                path: submitInfo.fileName,\r\n                message: submitInfo.msg,\r\n                committer: {\r\n                    name: submitInfo.committer,\r\n                },\r\n                content: submitInfo.fileBase64,\r\n            }\r\n        })\r\n        .done((d, textStatus, request)=>{\r\n            d = JSON.parse(d)\r\n            if( d.content === undefined ){ //put fail\r\n                $('#modalMsg').html(`<p>ERROR\uFF1A${d.message}</p>`)\r\n            }\r\n            else{\r\n                $('#modalMsg').html(`<p>upload success</p><p><a href='${d.content.html_url}'>File on github</p>`)\r\n            }\r\n        })\r\n        .fail((jqXHR, textStatus)=>{\r\n            $('#modalMsg').html(`JQuery AJAX ERROR\uFF1A${textStatus}`)\r\n        })\r\n        //------ send file by cloudflare worker ------\r\n\r\n\r\n        // ------ send file by your browser ------\r\n        // you can use your github key to upload file from browser if you wish\r\n\r\n\r\n        // ------- check file exsit on github --------\r\n        /*const octokit = new Octokit({\r\n            auth: `YOUR_GITHUB_KEY`,\r\n        });\r\n        //test if file exist\r\n\r\n        submitInfo.sha = await fileExist(submitInfo.fileName)\r\n        fileUpload(submitInfo)\r\n\r\n        async function fileExist(fileName){\r\n            try {\r\n                // your code here that sends at least one Octokit request\r\n                const r = await octokit.request('GET /repos/{owner}/{repo}/contents/{path}', {\r\n                    owner: 'maisakiberryfan',\r\n                    repo: 'website',\r\n                    path: fileName,\r\n                    ref: 'test',\r\n                    headers: {\r\n                        'X-GitHub-Api-Version': '2022-11-28'\r\n                    }\r\n                })\r\n                \r\n                return r.data.sha\r\n    \r\n            } catch (error) {\r\n                // Octokit errors always have a `error.status` property which is the http response code nad it's instance of RequestError\r\n                if (error instanceof RequestError) {\r\n                    //new file\r\n                    return null\r\n                } else {\r\n                // handle all other errors\r\n                throw error;\r\n                }\r\n            }\r\n        }\r\n\r\n        // ------- upload to github --------\r\n        async function fileUpload(file){\r\n            try {\r\n                                \r\n                await octokit.request('PUT /repos/{owner}/{repo}/contents/{path}', {\r\n                    owner: 'maisakiberryfan',\r\n                    repo: 'website',\r\n                    path: file.fileName,\r\n                    message: file.msg,\r\n                    committer: {\r\n                        name: file.committer,\r\n                        email: 'no-reply@m-b.win'\r\n                    },\r\n                    content: file.fileBase64,\r\n                    sha: file.sha,\r\n                    branch: 'test',\r\n                    headers: {\r\n                    'X-GitHub-Api-Version': '2022-11-28'\r\n                    }\r\n                })\r\n\r\n                $('#modalMsg').html('upload success')\r\n    \r\n            } catch (error) {\r\n                // Octokit errors always have a `error.status` property which is the http response code nad it's instance of RequestError\r\n                if (error instanceof RequestError) {\r\n                    $('#modalMsg').html(error.message)\r\n                } else {\r\n                // handle all other errors\r\n                throw error;\r\n                }\r\n            }\r\n\r\n            msgModal.show()\r\n        }*/\r\n\r\n\r\n    })//end form sumbit\r\n\r\n})\r\n    \r\n"],
  "mappings": "oJAAA,IAAAA,EAAAC,EAAA,KACA,IAAAC,EAAc,OACdC,IACAC,IAEA,OAAO,EAAI,OAAO,OAAS,EAAAC,QAC3B,OAAO,UAAYC,KAEnB,EAAAD,SAAE,SAAU,CAER,IAAIE,EAAW,IAAcC,EAAM,SAAS,eAAe,OAAO,CAAC,KAGnE,EAAAH,SAAE,aAAa,EAAE,GAAG,SAAWI,GAAM,CAErC,CAAC,KAED,EAAAJ,SAAE,OAAO,EAAE,GAAG,SAAU,MAAOI,GAAI,CAC/BA,EAAE,eAAe,KAGjB,EAAAJ,SAAE,WAAW,EAAE,KAAK,WAAW,EAC/BE,EAAS,KAAK,EAEd,IAAMG,EAAO,SAAS,eAAe,YAAY,EAAE,MAAM,CAAC,EAE1D,IAAIC,EAAa,CACb,aAAW,EAAAN,SAAE,YAAY,EAAE,IAAI,EAC/B,OAAK,EAAAA,SAAE,MAAM,EAAE,IAAI,EACnB,SAAUK,EAAK,KACf,WAAW,MAAME,EAASF,CAAI,CAClC,EAEA,SAASE,EAASF,EAAK,CAEnB,OAAO,IAAI,QAAQ,CAACG,EAASC,IAAW,CACpC,IAAMC,EAAS,IAAI,WACnBA,EAAO,cAAcL,CAAI,EACzBK,EAAO,OAAS,IAAMF,EAAQE,EAAO,OAAO,MAAM,GAAG,EAAE,CAAC,CAAC,EACzDA,EAAO,QAAUD,CACrB,CAAC,CACL,CAGA,EAAAT,QAAE,KAAK,CACH,IAAI,6CACJ,OAAQ,OACR,KAAK,CACD,KAAMM,EAAW,SACjB,QAASA,EAAW,IACpB,UAAW,CACP,KAAMA,EAAW,SACrB,EACA,QAASA,EAAW,UACxB,CACJ,CAAC,EACA,KAAK,CAACK,EAAGC,EAAYC,IAAU,CAC5BF,EAAI,KAAK,MAAMA,CAAC,EACZA,EAAE,UAAY,UACd,EAAAX,SAAE,WAAW,EAAE,KAAK,iBAAYW,EAAE,OAAO,MAAM,KAG/C,EAAAX,SAAE,WAAW,EAAE,KAAK,oCAAoCW,EAAE,QAAQ,QAAQ,sBAAsB,CAExG,CAAC,EACA,KAAK,CAACG,EAAOF,IAAa,IACvB,EAAAZ,SAAE,WAAW,EAAE,KAAK,0BAAqBY,CAAU,EAAE,CACzD,CAAC,CAiFL,CAAC,CAEL,CAAC",
  "names": ["require_uploadtool", "__commonJSMin", "import_jquery", "init_bootstrap_esm", "init_bootstrap_min", "$", "bootstrap_esm_exports", "msgModal", "Modal", "e", "file", "submitInfo", "toBase64", "resolve", "reject", "reader", "d", "textStatus", "request", "jqXHR"]
}
