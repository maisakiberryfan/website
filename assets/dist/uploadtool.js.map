{
  "version": 3,
  "sources": ["../js/uploadtool.js"],
  "sourcesContent": ["// Local dependencies (bundled)\nimport $ from 'jquery'\nimport * as bootstrap from 'bootstrap'\nimport 'bootstrap/dist/css/bootstrap.min.css'\n\nwindow.$ = window.jQuery = $\nwindow.bootstrap = bootstrap\n\n$(async()=> {\n\n    var msgModal = new bootstrap.Modal(document.getElementById('modal'))\n\n    // ------- get file --------\n    $('#fileUpload').on('change', (e) => {\n        //alert('upload done')\n    });\n\n    $('#form').on('submit', async (e)=>{\n        e.preventDefault()\n\n        //show msg to user\n        $('#modalMsg').html('uploading')\n        msgModal.show()\n\n        const file = document.getElementById(\"fileUpload\").files[0]\n\n        var submitInfo = {\n            committer: $('#committer').val(),\n            msg: $('#msg').val(),\n            fileName: file.name,\n            fileBase64:await toBase64(file),\n        }\n\n        function toBase64(file){\n            //from https://stackoverflow.com/questions/36280818/how-to-convert-file-to-base64-in-javascript\n            return new Promise((resolve, reject) => {\n                const reader = new FileReader();\n                reader.readAsDataURL(file);\n                reader.onload = () => resolve(reader.result.split(',')[1]);\n                reader.onerror = reject;\n            });\n        }\n\n        //------ send file by cloudflare worker ------\n        $.ajax({\n            url:'https://githubuploader.katani.workers.dev/',\n            method: 'POST',\n            data:{\n                path: submitInfo.fileName,\n                message: submitInfo.msg,\n                committer: {\n                    name: submitInfo.committer,\n                },\n                content: submitInfo.fileBase64,\n            }\n        })\n        .done((d, textStatus, request)=>{\n            d = JSON.parse(d)\n            if( d.content === undefined ){ //put fail\n                $('#modalMsg').html(`<p>ERROR\uFF1A${d.message}</p>`)\n            }\n            else{\n                $('#modalMsg').html(`<p>upload success</p><p><a href='${d.content.html_url}'>File on github</p>`)\n            }\n        })\n        .fail((jqXHR, textStatus)=>{\n            $('#modalMsg').html(`JQuery AJAX ERROR\uFF1A${textStatus}`)\n        })\n        //------ send file by cloudflare worker ------\n\n\n        // ------ send file by your browser ------\n        // you can use your github key to upload file from browser if you wish\n\n\n        // ------- check file exsit on github --------\n        /*const octokit = new Octokit({\n            auth: `YOUR_GITHUB_KEY`,\n        });\n        //test if file exist\n\n        submitInfo.sha = await fileExist(submitInfo.fileName)\n        fileUpload(submitInfo)\n\n        async function fileExist(fileName){\n            try {\n                // your code here that sends at least one Octokit request\n                const r = await octokit.request('GET /repos/{owner}/{repo}/contents/{path}', {\n                    owner: 'maisakiberryfan',\n                    repo: 'website',\n                    path: fileName,\n                    ref: 'test',\n                    headers: {\n                        'X-GitHub-Api-Version': '2022-11-28'\n                    }\n                })\n                \n                return r.data.sha\n    \n            } catch (error) {\n                // Octokit errors always have a `error.status` property which is the http response code nad it's instance of RequestError\n                if (error instanceof RequestError) {\n                    //new file\n                    return null\n                } else {\n                // handle all other errors\n                throw error;\n                }\n            }\n        }\n\n        // ------- upload to github --------\n        async function fileUpload(file){\n            try {\n                                \n                await octokit.request('PUT /repos/{owner}/{repo}/contents/{path}', {\n                    owner: 'maisakiberryfan',\n                    repo: 'website',\n                    path: file.fileName,\n                    message: file.msg,\n                    committer: {\n                        name: file.committer,\n                        email: 'no-reply@m-b.win'\n                    },\n                    content: file.fileBase64,\n                    sha: file.sha,\n                    branch: 'test',\n                    headers: {\n                    'X-GitHub-Api-Version': '2022-11-28'\n                    }\n                })\n\n                $('#modalMsg').html('upload success')\n    \n            } catch (error) {\n                // Octokit errors always have a `error.status` property which is the http response code nad it's instance of RequestError\n                if (error instanceof RequestError) {\n                    $('#modalMsg').html(error.message)\n                } else {\n                // handle all other errors\n                throw error;\n                }\n            }\n\n            msgModal.show()\n        }*/\n\n\n    })//end form sumbit\n\n})\n    \n"],
  "mappings": "oJAAA,IAAAA,EAAAC,EAAA,KACA,IAAAC,EAAc,OACdC,IACAC,IAEA,OAAO,EAAI,OAAO,OAAS,EAAAC,QAC3B,OAAO,UAAYC,KAEnB,EAAAD,SAAE,SAAU,CAER,IAAIE,EAAW,IAAcC,EAAM,SAAS,eAAe,OAAO,CAAC,KAGnE,EAAAH,SAAE,aAAa,EAAE,GAAG,SAAWI,GAAM,CAErC,CAAC,KAED,EAAAJ,SAAE,OAAO,EAAE,GAAG,SAAU,MAAOI,GAAI,CAC/BA,EAAE,eAAe,KAGjB,EAAAJ,SAAE,WAAW,EAAE,KAAK,WAAW,EAC/BE,EAAS,KAAK,EAEd,IAAMG,EAAO,SAAS,eAAe,YAAY,EAAE,MAAM,CAAC,EAE1D,IAAIC,EAAa,CACb,aAAW,EAAAN,SAAE,YAAY,EAAE,IAAI,EAC/B,OAAK,EAAAA,SAAE,MAAM,EAAE,IAAI,EACnB,SAAUK,EAAK,KACf,WAAW,MAAME,EAASF,CAAI,CAClC,EAEA,SAASE,EAASF,EAAK,CAEnB,OAAO,IAAI,QAAQ,CAACG,EAASC,IAAW,CACpC,IAAMC,EAAS,IAAI,WACnBA,EAAO,cAAcL,CAAI,EACzBK,EAAO,OAAS,IAAMF,EAAQE,EAAO,OAAO,MAAM,GAAG,EAAE,CAAC,CAAC,EACzDA,EAAO,QAAUD,CACrB,CAAC,CACL,CAGA,EAAAT,QAAE,KAAK,CACH,IAAI,6CACJ,OAAQ,OACR,KAAK,CACD,KAAMM,EAAW,SACjB,QAASA,EAAW,IACpB,UAAW,CACP,KAAMA,EAAW,SACrB,EACA,QAASA,EAAW,UACxB,CACJ,CAAC,EACA,KAAK,CAACK,EAAGC,EAAYC,IAAU,CAC5BF,EAAI,KAAK,MAAMA,CAAC,EACZA,EAAE,UAAY,UACd,EAAAX,SAAE,WAAW,EAAE,KAAK,iBAAYW,EAAE,OAAO,MAAM,KAG/C,EAAAX,SAAE,WAAW,EAAE,KAAK,oCAAoCW,EAAE,QAAQ,QAAQ,sBAAsB,CAExG,CAAC,EACA,KAAK,CAACG,EAAOF,IAAa,IACvB,EAAAZ,SAAE,WAAW,EAAE,KAAK,0BAAqBY,CAAU,EAAE,CACzD,CAAC,CAiFL,CAAC,CAEL,CAAC",
  "names": ["require_uploadtool", "__commonJSMin", "import_jquery", "init_bootstrap_esm", "init_bootstrap_min", "$", "bootstrap_esm_exports", "msgModal", "Modal", "e", "file", "submitInfo", "toBase64", "resolve", "reject", "reader", "d", "textStatus", "request", "jqXHR"]
}
