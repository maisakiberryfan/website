<!DOCTYPE html>
<html data-bs-theme="dark">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link rel="stylesheet" href="https://unpkg.com/bootstrap@5.3.3/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/tabulator-bootstrap5-custom.css">
	<link rel="stylesheet" href="https://unpkg.com/select2@4.1.0-rc.0/dist/css/select2.min.css">
	<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.css">
	<link rel="stylesheet" href="https://unpkg.com/video.js@8.21.1/dist/video-js.min.css">
	<link rel="icon" type="image/x-icon" href="favicon.ico">
	<script defer src="https://unpkg.com/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.js"></script>
	<script type="module" src="assets/js/tool.js"></script>
	<base target="_blank">
	<meta name="description" content="An Unofficial fansite about è‹ºå’²ã¹ã‚Šãƒ(Maisaki Berry).Main content are singing data.">
	<style>
		/* Select2 dark theme fixes */
		.select2-results__option, .select2-selection__choice, .select2-selection__clear {
			color: black !important;
		}

		.select2-dropdown {
			background-color: white !important;
			border: 1px solid #ced4da !important;
		}

		.select2-results__options {
			background-color: white !important;
			color: black !important;
		}

		.select2-results__option--highlighted {
			background-color: #0d6efd !important;
			color: white !important;
		}

		.select2-search__field {
			background-color: white !important;
			color: black !important;
		}

		.select2-selection {
			background-color: white !important;
			border: 1px solid #ced4da !important;
		}

		.select2-selection__rendered {
			color: black !important;
		}

		.figure-cloth {
			width: 324px;
			height: 726px;
			margin: 3px
		}
		.card {
			width: 480px;
		}

		/* Context Menu Styles */
		.context-menu {
			position: fixed;
			background: var(--bs-dark);
			border: 1px solid var(--bs-border-color);
			border-radius: 4px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.3);
			z-index: 9999;
			min-width: 250px;
			padding: 4px 0;
		}

		.context-menu-item {
			padding: 10px 16px;
			cursor: pointer;
			color: var(--bs-light);
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.context-menu-item:hover {
			background: var(--bs-primary);
		}

		.context-menu-divider {
			height: 1px;
			background: var(--bs-border-color);
			margin: 4px 0;
		}
	</style>
</head>

<body>
	<header id="nav"><!-- navbar --></header>

	<div id='content' class="container my-5 pt-5"></div>

	<!-- Modal for message -->
	<div class="modal fade" id="modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitle">Notice</h1>
				</div>
				<div class="modal-body" id='modalMsg'></div>
				<div class="modal-footer" id="modalFooter">
					<!--<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id=""></button>-->
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for add setlist row -->
	<div class="modal fade" id="modalAddRow" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleAddRow" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleAddRow">Add Row</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id='addRowInfo'>
					<form>
						<div class="form-group row my-2">
							<label for="YTLink" class="col-sm-3 col-form-label">YTLink</label>
							<div class="col-sm-8">
							  <input type="text" class="form-control YTInfoQ" id="YTLink" placeholder="https://www.youtube.com/watch?v=OOO">
							</div>
						</div>
						<div class="form-group row my-2">
						  <label for="setlistDate" class="col-sm-3 col-form-label">Date</label>
						  <div class="col-sm-5">
						  	<input type="input" class="form-control" id="setlistDate" placeholder="YYYY/MM/DD">
						  </div>
						  <div class="col-sm-3">
							<span id="dateCheck" class="text-danger"></span>
						  </div>
						</div>
						<div class="form-group row my-2">
						  <label for="songs" class="col-sm-3 col-form-label">How many songs</label>
						  <div class="col-sm-8">
							<input type="text" class="form-control" id="songs" value="20">
						  </div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="addRowData">Add</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for add streamlist row -->
	<div class="modal fade" id="modalAddStreamRow" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleAddStreamRow" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleAddStreamRow">Add Row</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id='addStreamRowInfo'>
					<!-- éŒ¯èª¤è¨Šæ¯å€åŸŸ -->
					<div id="addStreamRowError" class="alert alert-danger alert-dismissible fade show" role="alert" style="display: none;">
						<strong>âŒ æ–°å¢å¤±æ•—</strong>
						<div id="addStreamRowErrorMsg"></div>
						<button type="button" class="btn-close" onclick="document.getElementById('addStreamRowError').style.display='none'"></button>
					</div>

					<form>
						<div class="form-group row my-2">
							<label for="YTID" class="col-sm-3 col-form-label">YTLink</label>
							<div class="col-sm-8">
							  <input type="text" class="form-control" id="YTID" placeholder="https://www.youtube.com/watch?v=OOO">
							</div>
							<input type="text" class="form-control" id="videoID" hidden>
						</div>
						<div class="form-group row my-2">
							<div class="col-sm-3"></div>
							<div class="col-sm-8">
							  <div id="streamMsg"  class="text-danger">ã€€</div>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="streamTitle" class="col-sm-3 col-form-label">Title</label>
							<div class="col-sm-8">
							  <input type="text" class="form-control" id="streamTitle" disabled>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="streamTime" class="col-sm-3 col-form-label">local time</label>
							<div class="col-sm-5">
							  <input type="text" class="form-control" id="streamTime" placeholder="YYYY/MM/DD HH:mm"  disabled>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="category" class="col-sm-3 col-form-label">category</label>
							<div class="col-sm-5">
								<select name="category" id="category" multiple></select>
							</div>
						</div>
						<div class="form-group row my-2">
							<div class="col-sm-3"></div>
							<div class="col-sm-8">
								<span>Select multiple categories or type to add new ones.</span>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" id="addStreamRowData">Add</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for add songlist row -->
	<div class="modal fade" id="modalAddSong" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleAddSong" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleAddSong">Add Song</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id='addSongInfo'>
					<form>
						<div class="form-group row my-2">
							<label for="songName" class="col-sm-3 col-form-label">Song Name *</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="songName" required>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="songNameEn" class="col-sm-3 col-form-label">Song Name (EN)</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="songNameEn">
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="artistName" class="col-sm-3 col-form-label">Artist *</label>
							<div class="col-sm-9">
								<select class="form-control" id="artistName" required>
									<option value="">Select or type artist name...</option>
								</select>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="artistNameEn" class="col-sm-3 col-form-label">Artist (EN)</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="artistNameEn">
								<small class="form-text text-muted">Auto-filled when selecting existing artist, but can be manually edited</small>
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="genreName" class="col-sm-3 col-form-label">Genre</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="genreName">
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="tieupName" class="col-sm-3 col-form-label">Tie-up</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" id="tieupName">
							</div>
						</div>
						<div class="form-group row my-2">
							<label for="songNoteText" class="col-sm-3 col-form-label">Note</label>
							<div class="col-sm-9">
								<textarea class="form-control" id="songNoteText" rows="2"></textarea>
							</div>
						</div>
						<div class="form-group row my-2">
							<div class="col-sm-3"></div>
							<div class="col-sm-9">
								<span class="text-muted">* Required fields</span>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="addSongData">Add Song</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for batch setlist editing -->
	<div class="modal fade" id="modalBatchEdit" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleBatchEdit" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleBatchEdit">ğŸ“ æ‰¹æ¬¡ç·¨è¼¯æ­Œå–® - Batch Edit Setlist</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<h6>Stream Information</h6>
						<p class="mb-1"><strong>ID:</strong> <span id="batchStreamID"></span></p>
						<p class="mb-1"><strong>Title:</strong> <span id="batchStreamTitle"></span></p>
						<div id="batchLoadStatus" class="alert alert-info mt-2" style="display: none;"></div>
					</div>

					<div class="row mb-3">
						<div class="col-md-4">
							<label for="batchStartTrack" class="form-label">èµ·å§‹ Track ç·¨è™Ÿ (Start Track)</label>
							<input type="number" class="form-control" id="batchStartTrack" value="1" min="1">
						</div>
						<div class="col-md-4">
							<label for="batchTotalSongs" class="form-label">ç¸½æ›²æ•¸ (Total Songs)</label>
							<input type="number" class="form-control" id="batchTotalSongs" value="20" min="1" max="100">
						</div>
						<div class="col-md-4">
							<label for="batchSegment" class="form-label">æ­Œå›ç·¨è™Ÿ (Segment)</label>
							<input type="number" class="form-control" id="batchSegment" value="1" min="1">
							<small class="form-text text-muted">ç•¶å¤©ç¬¬å¹¾æ¬¡æ­Œå›ï¼ˆæ•´å ´å…±ç”¨ï¼‰</small>
						</div>
					</div>

					<div class="mb-2 d-flex gap-2">
						<button type="button" class="btn btn-primary btn-sm" id="generateBatchTable">ç”¢ç”Ÿè¡¨æ ¼ (Generate Table)</button>
						<button type="button" class="btn btn-success btn-sm" id="batchAddNewSong">â• æ–°å¢æ­Œæ›² (Add New Song)</button>
					</div>

					<div id="batchTableContainer">
						<!-- Tabulator table will be rendered here -->
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="saveBatchSetlist">Save All</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for quick add setlist (live streaming) -->
	<div class="modal fade" id="modalQuickAdd" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleQuickAdd" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleQuickAdd">âš¡ å¿«é€Ÿæ–°å¢æ­Œå–® - Quick Add (Live)</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" style="position: relative; min-height: 300px;">

				<!-- è¼‰å…¥é®ç½©å±¤ -->
				<div id="quickAddLoadingOverlay" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); z-index: 1050; border-radius: 0.375rem;">
					<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white;">
						<div class="spinner-border mb-3" role="status" style="width: 3rem; height: 3rem;">
							<span class="visually-hidden">è¼‰å…¥ä¸­...</span>
						</div>
						<div style="font-size: 1.1rem; font-weight: 500;">æ­£åœ¨æª¢æ¸¬ç¾æœ‰æ­Œå–®...</div>
					</div>
				</div>

				<!-- éŒ¯èª¤è¨Šæ¯å€åŸŸ -->
				<div id="quickAddError" class="alert alert-danger alert-dismissible fade show" role="alert" style="display: none;">
					<strong>âŒ æ“ä½œå¤±æ•—</strong>
						<div id="quickAddErrorMsg"></div>
						<button type="button" class="btn-close" onclick="document.getElementById('quickAddError').style.display='none'; document.getElementById('quickAddErrorMsg').innerHTML=''"></button>
					</div>
					
					<div class="mb-3">
						<h6>Stream Information</h6>
						<p class="mb-1"><strong>ID:</strong> <span id="quickStreamID"></span></p>
						<p class="mb-1"><strong>Title:</strong> <span id="quickStreamTitle"></span></p>
					</div>

					<div class="alert alert-info">
						<small>ğŸ’¡ æ­¤æ¨¡å¼é©åˆç›´æ’­ä¸­å¿«é€Ÿè¨˜éŒ„æ­Œæ›²ã€‚æŒ‰ Enter é€£çºŒæ–°å¢ï¼ŒæŒ‰ Esc é—œé–‰è¦–çª—ã€‚</small>
					</div>

					<div class="row mb-3">
						<div class="col-md-6">
							<label for="quickStartTrack" class="form-label">èµ·å§‹ Track ç·¨è™Ÿ (Start Track) *</label>
							<input type="number" class="form-control" id="quickStartTrack" placeholder="é¦–æ¬¡éœ€å¡«å¯«" min="1" required>
							<small class="form-text text-muted">ç¬¬ä¸€æ¬¡å¡«å¯«å¾Œæœƒè‡ªå‹•éå¢</small>
						</div>
						<div class="col-md-6">
							<label for="quickSegment" class="form-label">æ­Œå›ç·¨è™Ÿ (Segment)</label>
							<input type="number" class="form-control" id="quickSegment" value="1" min="1">
							<small class="form-text text-muted">ç•¶å¤©ç¬¬å¹¾æ¬¡æ­Œå›</small>
						</div>
					</div>

					<hr>

					<div class="mb-3" id="quickAddFormSection" style="display: none;">
						<div class="alert alert-success">
							<strong>ä¸‹ä¸€é¦– Track:</strong> <span id="quickNextTrack">-</span>
						</div>

						<div class="mb-3">
							<div class="d-flex justify-content-between align-items-center mb-2">
								<label for="quickSongSelect" class="form-label mb-0">æ­Œæ›² (Song) *</label>
								<button type="button" class="btn btn-success btn-sm" id="quickAddNewSong">
									â• æ–°å¢åˆå›æ­Œæ›²
								</button>
							</div>
							<select class="form-control" id="quickSongSelect" required>
								<option value="">æœå°‹æ­Œæ›²...</option>
							</select>
						</div>

						<div class="mb-3">
							<label for="quickNote" class="form-label">å‚™è¨» (Note)</label>
							<input type="text" class="form-control" id="quickNote" placeholder="é¸å¡«">
						</div>

						<div class="d-grid gap-2">
							<button type="button" class="btn btn-primary" id="quickAddSongBtn">
								<strong>Enter</strong> æ–°å¢æ­Œæ›²
							</button>
						</div>
					</div>

					<div class="mb-3" id="quickStartSection">
						<div class="d-grid gap-2">
							<button type="button" class="btn btn-success btn-lg" id="quickStartBtn">
								é–‹å§‹è¨˜éŒ„ (Start)
							</button>
						</div>
					</div>

					<hr>

					<div class="mb-3">
						<h6>å·²æ–°å¢æ¸…å–® (Added Songs)</h6>
						<div id="quickAddedList" class="border rounded p-2" style="max-height: 200px; overflow-y: auto; min-height: 50px;">
							<small class="text-muted">å°šæœªæ–°å¢ä»»ä½•æ­Œæ›²</small>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é—œé–‰ (Close)</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal for bilingual field editing -->
	<div class="modal fade" id="modalBilingualEdit" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalTitleBilingualEdit" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalTitleBilingualEdit">ç·¨è¼¯ / Edit</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="bilingualJA" class="form-label">
							<span id="bilingualFieldLabel">æ—¥æ–‡</span> (Japanese)
						</label>
						<input type="text" class="form-control" id="bilingualJA" placeholder="æ—¥æœ¬èªã§å…¥åŠ›">
					</div>
					<div class="mb-3">
						<label for="bilingualEN" class="form-label">
							è‹±æ–‡ (English)
						</label>
						<input type="text" class="form-control" id="bilingualEN" placeholder="Enter in English">
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="saveBilingual">Save</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Connection Error Alert (fixed position at top) -->
	<div id="connectionErrorAlert" class="alert alert-danger alert-dismissible fade" role="alert" style="display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; min-width: 400px; max-width: 600px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
		<h5 class="alert-heading">
			<i class="bi bi-exclamation-triangle-fill me-2"></i>
			ç„¡æ³•é€£ç·šåˆ°è³‡æ–™åº«
		</h5>
		<p class="mb-2" id="connectionErrorMessage">è«‹æª¢æŸ¥ Hyperdrive æœå‹™æ˜¯å¦å•Ÿå‹•ï¼ˆ<code>http://localhost:8785</code>ï¼‰ï¼Œæˆ–ç¨å¾Œå†è©¦ã€‚</p>
		<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>

</body>
</html>